(this["webpackJsonpconsole-fe"]=this["webpackJsonpconsole-fe"]||[]).push([[0],{167:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(28),s=n.n(a),o=(n(84),n(85),n(78)),i=n(7),u=n(36),l=n(32),d=n(8),j=n.n(d),f=n(16),b=n(18),p=n(168),g=n(170),m=n(9),O="http://localhost:3020/api",x={loadPorts:"".concat(O,"/getPorts"),loadConfig:"".concat(O,"/loadConf"),saveConfig:"".concat(O,"/saveConf"),connectToComPort:"".concat(O,"/connectToSerial"),sendCommand:"".concat(O,"/sendCommand")},h=n(17),v=n.n(h),C=n(38),y=Object(C.b)({name:"Settings",initialState:{categories:[],selectedCategory:{id:0,name:"-"},comPorts:[],selectedComPort:"",deskNum:0,server:"",overrideCategory:"",configLoaded:!1},reducers:{setCategories:function(e,t){e.categories=t.payload},setSelectedCategory:function(e,t){e.selectedCategory=t.payload},setComPorts:function(e,t){e.comPorts=t.payload},setSelectedComPort:function(e,t){e.selectedComPort=t.payload},setDeskNum:function(e,t){e.deskNum=t.payload},setOverrideCategory:function(e,t){e.overrideCategory=t.payload},setConfigLoaded:function(e){e.configLoaded=!0},setServer:function(e,t){e.server=t.payload}}}),k=y.actions,S=k.setCategories,w=k.setSelectedCategory,N=k.setComPorts,P=k.setSelectedComPort,D=k.setDeskNum,I=(k.setOverrideCategory,k.setConfigLoaded),z=k.setServer,E=y.reducer,T=n(79),A=n(2),J={headerStyle:{textAlign:"center"},cardContainer:{margin:20,display:"flex",flexDirection:"row",justifyContent:"space-around"},buttonsStyle:{margin:25,display:"flex",flexDirection:"row",justifyContent:"space-around"}},L=function(e){var t=Object(m.b)(),n=Object(m.c)((function(e){return e.Config.categories})),c=Object(m.c)((function(e){return e.Config.selectedCategory})),a=Object(m.c)((function(e){return e.Config.deskNum})),s=Object(m.c)((function(e){return e.Config.comPorts})),o=Object(m.c)((function(e){return e.Config.selectedComPort})),i=Object(m.c)((function(e){return e.Config.server})),d=Object(r.useState)({selectedCategory:c?c.id:1,selectedComPort:o,deskNum:a,server:i}),O=Object(b.a)(d,2),h=O[0],C=O[1],y=Object(r.useState)([]),k=Object(b.a)(y,2),S=k[0],N=k[1],I=Object(r.useState)(null),E=Object(b.a)(I,2),L=E[0],R=E[1],B=function(){var r=Object(f.a)(j.a.mark((function r(){var c,a;return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t(P(h.selectedComPort)),t(z(h.server)),c=n.filter((function(e){return e.id==h.selectedCategory})),c[0]?c[0]:{id:0,name:""},t(w(c[0])),t(D(parseInt(h.deskNum))),r.prev=6,a={desk:h.deskNum,category:h.selectedCategory,comPort:h.selectedComPort,server:h.server},r.next=10,v.a.post(x.saveConfig,a);case 10:localStorage.setItem("config",JSON.stringify(a)),e.history.push("/"),r.next=16;break;case 14:r.prev=14,r.t0=r.catch(6);case 16:case"end":return r.stop()}}),r,null,[[6,14]])})));return function(){return r.apply(this,arguments)}}(),F=function(e){var t=e.name,n=e.value,r=Object(l.a)(Object(l.a)({},h),{},Object(u.a)({},t,n));C(r)};Object(r.useEffect)((function(){var e=[];s.map((function(t){e.push({value:t,label:t})})),N(e),R({value:o,label:o})}),[]);return Object(A.jsxs)("div",{className:"",children:[Object(A.jsx)("div",{className:"alert alert-secondary",style:J.headerStyle,children:Object(A.jsx)("h1",{children:"Settings"})}),Object(A.jsx)("div",{className:"container",children:Object(A.jsxs)(p.a,{children:[Object(A.jsx)(p.a.Control,{as:"select",size:"lg",name:"selectedCategory",onChange:function(e){return F(e.target)},value:h.selectedCategory,children:n.map((function(e){return Object(A.jsx)("option",{value:e.id,children:e.name},e.id)}))}),Object(A.jsx)("br",{}),Object(A.jsx)(T.a,{value:L,onChange:function(e){F({name:"selectedComPort",value:e.value}),R(e)},options:S}),Object(A.jsx)("br",{}),Object(A.jsx)(p.a.Control,{size:"lg",type:"number",placeholder:"Desk Number",name:"deskNum",value:h.deskNum,onChange:function(e){return F(e.target)}}),Object(A.jsx)("br",{}),Object(A.jsx)(p.a.Control,{size:"lg",type:"text",placeholder:"Server",name:"server",value:h.server,onChange:function(e){return F(e.target)}}),Object(A.jsx)("br",{}),Object(A.jsx)(g.a,{variant:"success",size:"lg",onClick:B,children:"Save"})]})})]})},R=n(169),B=function(e){var t=e.title,n=e.content,r=e.type;return Object(A.jsx)("div",{children:Object(A.jsxs)(R.a,{className:r+" text-white",children:[Object(A.jsx)(R.a.Header,{children:Object(A.jsx)("h1",{children:t})}),Object(A.jsx)(R.a.Body,{className:"bg-secondary",children:Object(A.jsx)(R.a.Title,{children:Object(A.jsx)("h1",{children:n})})})]})})},F=n(76),M={headerStyle:{display:"flex",flexDircetion:"row",justifyContent:"space-between",textAlign:"center"},cardContainer:{margin:20,display:"flex",flexDirection:"row",justifyContent:"space-around",marginBottom:50},buttonsStyle:{margin:35,display:"flex",flexDirection:"row",justifyContent:"space-around"}},W=function(e){var t=Object(m.c)((function(e){return e.Config.selectedCategory})),n=Object(m.c)((function(e){return e.Config.deskNum})),c=Object(r.useState)(0),a=Object(b.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(0),u=Object(b.a)(i,2),l=u[0],d=u[1],p=Object(r.useState)(!0),O=Object(b.a)(p,2),h=O[0],C=O[1],y=Object(r.useState)(!1),k=Object(b.a)(y,2),S=k[0],N=k[1],P=Object(m.b)(),D=Object(m.c)((function(e){return e.Config.server})),I={loadAllCats:"".concat(D,"/api/cats"),getCategoryStatus:"".concat(D,"/api/cats/getStatus"),getNextCustomer:"".concat(D,"/api/cats/popCustomer"),repeatCustomer:"".concat(D,"/api/cats/repeatCustomerNumber"),socketServer:"".concat(D,"/")},z=function(){var e=Object(f.a)(j.a.mark((function e(n,r){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{c=n.filter((function(e){return parseInt(e.id)===parseInt(t.id)}))[0],o(c.current),d(null===c.waiting?0:c.waiting)}catch(r){console.log(r.message)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(f.a)(j.a.mark((function e(t){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N(!0),e.next=4,v.a.post(I.getNextCustomer,{id:t,window:n});case 4:return r=e.sent,c=r.data,e.next=8,v.a.post("".concat(x.sendCommand,"/"),{type:"A",num:c.customer});case 8:return N(!1),e.abrupt("return",c.customer);case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0.message),N(!1);case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(f.a)(j.a.mark((function e(){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==t.id){e.next=14;break}return e.next=3,E(3);case 3:if(n=e.sent,console.log("Customer",n),!n){e.next=10;break}return P(w({id:3,name:"Emergency"})),e.abrupt("return");case 10:return e.next=12,E(1);case 12:e.next=26;break;case 14:if(3!==t.id){e.next=24;break}return e.next=17,E(3);case 17:if(e.sent){e.next=22;break}return e.next=21,E(1);case 21:P(w({id:1,name:"Receiption"}));case 22:e.next=26;break;case 24:return e.next=26,E(t.id);case 26:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),J=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,h){e.next=5;break}T(),e.next=7;break;case 5:return e.next=7,v.a.post("".concat(x.sendCommand,"/"),{type:"ON",num:null});case 7:C(!h),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post(I.repeatCustomer,{num:s,window:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)(Object(f.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(I.getCategoryStatus);case 2:t=e.sent,n=t.data,z(n.data,"http"),Object(F.io)(I.socketServer,{transports:["websocket"]}).on("cats",(function(e){z(e.cats,"socket")}));case 7:case"end":return e.stop()}}),e)}))),[t]),Object(A.jsx)("div",{children:Object(A.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[Object(A.jsxs)("div",{className:"alert alert-dark",style:M.headerStyle,children:[Object(A.jsx)("h2",{children:(null===t||void 0===t?void 0:t.name)?t.name:"-"}),Object(A.jsxs)("h2",{children:["Desk: ",n]}),Object(A.jsx)(g.a,{variant:"default",size:"lg",onClick:function(){return e.history.push("/settings")},children:Object(A.jsx)("span",{style:{fontSize:30,fontWeight:"bold",margin:0},children:"..."})})]}),Object(A.jsxs)("div",{style:M.cardContainer,children:[Object(A.jsx)(B,{title:"Current",content:s,type:"bg-info"}),Object(A.jsx)(B,{title:"Waiting",content:l,type:"bg-success"})]}),Object(A.jsxs)("div",{style:M.buttonsStyle,children:[Object(A.jsx)(g.a,{variant:"primary",size:"lg",onClick:T,disabled:S,children:"Next"}),Object(A.jsx)(g.a,{variant:"primary",size:"lg",onClick:L,disabled:S,children:"Repeat"}),Object(A.jsx)(g.a,{variant:h?"success":"danger",size:"lg",onClick:J,disabled:S,children:h?"ON":"OFF"})]})]})})},H=n(77),q=n.n(H),G=n.p+"static/media/logo.4b7f5575.jpg",K=function(e){var t=Object(m.b)(),n=Object(m.c)((function(e){return e.Config.configLoaded})),c=Object(r.useState)(!1),a=Object(b.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(!0),u=Object(b.a)(i,2),d=u[0],p=u[1],g=function(){var e=Object(f.a)(j.a.mark((function e(){var n,r,c,a,s,o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(S(n=[{id:1,name:"Receiption"},{id:2,name:"M.R.I"}])),e.next=5,v.a.get(x.loadPorts);case 5:if(r=e.sent,c=r.data,t(N(c)),a=JSON.parse(localStorage.getItem("config"))){e.next=16;break}return e.next=12,v.a.get(x.loadConfig);case 12:s=e.sent,o=s.data,a=o,localStorage.setItem("config",JSON.stringify(a));case 16:t(D(a.desk)),t(P(a.comPort)),t(z(a.server)),i=n.filter((function(e){return parseInt(e.id)===parseInt(a.category)})),t(w(i[0])),t(I()),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),console.log(e.t0.message);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)(Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(x.connectToComPort);case 2:return t=e.sent,500===t.data.status&&o(!0),e.next=7,g();case 7:setTimeout((function(){p(!1)}),2e3);case 8:case"end":return e.stop()}}),e)}))),[]),Object(A.jsxs)("div",{children:[!d&&Object(A.jsxs)("div",{children:[s&&Object(A.jsx)(q.a,{title:"Serial Port Error",type:"error",onConfirm:function(){return o(!1)},children:Object(A.jsx)("h4",{children:"Please check cable is connected"})}),n&&Object(A.jsx)(W,Object(l.a)({},e))]}),d&&Object(A.jsx)("div",{children:Object(A.jsx)("img",{src:G,style:{heigh:"100vh",width:"100%",marginTop:"auto"}})})]})};var Q=function(){return Object(A.jsx)("div",{className:"App",children:Object(A.jsx)(o.a,{children:Object(A.jsxs)(i.c,{children:[Object(A.jsx)(i.a,{path:"/settings",component:L}),Object(A.jsx)(i.a,{path:"/",component:K})]})})})},U=(n(166),Object(C.a)({reducer:{Config:E}}));s.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(m.a,{store:U,children:Object(A.jsx)("div",{style:{backgroundColor:"a",height:"100vh"},children:Object(A.jsx)(Q,{})})})}),document.getElementById("root"))},84:function(e,t,n){},85:function(e,t,n){}},[[167,1,2]]]);
//# sourceMappingURL=main.92d9f788.chunk.js.map