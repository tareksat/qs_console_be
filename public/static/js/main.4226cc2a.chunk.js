(this["webpackJsonpconsole-fe"]=this["webpackJsonpconsole-fe"]||[]).push([[0],{150:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(34),s=n.n(a),o=(n(79),n(80),n(74)),i=n(7),u=n(30),l=n(26),d=n(8),j=n.n(d),f=n(16),b=n(25),p=n(151),g=n(153),O=n(9),m="http://localhost:3020/api",x={loadPorts:"".concat(m,"/getPorts"),loadConfig:"".concat(m,"/loadConf"),saveConfig:"".concat(m,"/saveConf"),connectToComPort:"".concat(m,"/connectToSerial"),sendCommand:"".concat(m,"/sendCommand")},h=n(13),v=n.n(h),C=n(36),y=Object(C.b)({name:"Settings",initialState:{categories:[],selectedCategory:{id:0,name:"-"},comPorts:[],selectedComPort:"",deskNum:0,server:"",overrideCategory:"",configLoaded:!1},reducers:{setCategories:function(e,t){e.categories=t.payload},setSelectedCategory:function(e,t){e.selectedCategory=t.payload},setComPorts:function(e,t){e.comPorts=t.payload},setSelectedComPort:function(e,t){e.selectedComPort=t.payload},setDeskNum:function(e,t){e.deskNum=t.payload},setOverrideCategory:function(e,t){e.overrideCategory=t.payload},setConfigLoaded:function(e){e.configLoaded=!0},setServer:function(e,t){e.server=t.payload}}}),k=y.actions,S=k.setCategories,w=k.setSelectedCategory,N=k.setComPorts,P=k.setSelectedComPort,I=k.setDeskNum,z=(k.setOverrideCategory,k.setConfigLoaded),D=k.setServer,T=y.reducer,A=n(1),J={headerStyle:{textAlign:"center"},cardContainer:{margin:20,display:"flex",flexDirection:"row",justifyContent:"space-around"},buttonsStyle:{margin:25,display:"flex",flexDirection:"row",justifyContent:"space-around"}},L=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.Config.categories})),c=Object(O.c)((function(e){return e.Config.selectedCategory})),a=Object(O.c)((function(e){return e.Config.deskNum})),s=Object(O.c)((function(e){return e.Config.comPorts})),o=Object(O.c)((function(e){return e.Config.selectedComPort})),i=Object(O.c)((function(e){return e.Config.server})),d=(Object(O.c)((function(e){return e.Config.overrideCategory})),Object(r.useState)({selectedCategory:c.id,selectedComPort:o,deskNum:a,server:i})),m=Object(b.a)(d,2),h=m[0],C=m[1],y=function(){var r=Object(f.a)(j.a.mark((function r(){var c,a;return j.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t(P(h.selectedComPort)),t(D(h.server)),c=n.filter((function(e){return e.id==h.selectedCategory})),c[0]?c[0]:{id:0,name:""},t(w(c[0])),t(I(parseInt(h.deskNum))),r.prev=6,a={desk:h.deskNum,category:h.selectedCategory,comPort:h.selectedComPort,server:h.server},r.next=10,v.a.post(x.saveConfig,a);case 10:localStorage.setItem("config",JSON.stringify(a)),e.history.push("/"),r.next=16;break;case 14:r.prev=14,r.t0=r.catch(6);case 16:case"end":return r.stop()}}),r,null,[[6,14]])})));return function(){return r.apply(this,arguments)}}(),k=function(e){var t=e.name,n=e.value;if("selectedCategory"===t){var r=Object(l.a)(Object(l.a)({},h),{},Object(u.a)({},t,n));C(r)}else{var c=Object(l.a)(Object(l.a)({},h),{},Object(u.a)({},t,n));C(c)}};return Object(A.jsxs)("div",{className:"",children:[Object(A.jsx)("div",{className:"alert alert-secondary",style:J.headerStyle,children:Object(A.jsx)("h1",{children:"Settings"})}),Object(A.jsx)("div",{className:"container",children:Object(A.jsxs)(p.a,{children:[Object(A.jsx)(p.a.Control,{as:"select",size:"lg",name:"selectedCategory",onChange:function(e){return k(e.target)},value:h.selectedCategory,children:n.map((function(e){return Object(A.jsx)("option",{value:e.id,children:e.name},e.id)}))}),Object(A.jsx)("br",{}),Object(A.jsx)(p.a.Control,{as:"select",size:"lg",onChange:function(e){return k(e.target)},name:"selectedComPort",value:h.selectedComPort,children:s.map((function(e,t){return Object(A.jsx)("option",{value:e,children:e},t)}))}),Object(A.jsx)("br",{}),Object(A.jsx)(p.a.Control,{size:"lg",type:"number",placeholder:"Desk Number",name:"deskNum",value:h.deskNum,onChange:function(e){return k(e.target)}}),Object(A.jsx)("br",{}),Object(A.jsx)(p.a.Control,{size:"lg",type:"text",placeholder:"Server",name:"server",value:h.server,onChange:function(e){return k(e.target)}}),Object(A.jsx)("br",{}),Object(A.jsx)(g.a,{variant:"success",size:"lg",onClick:y,children:"Save"})]})})]})},E=n(152),R=function(e){var t=e.title,n=e.content,r=e.type;return Object(A.jsx)("div",{children:Object(A.jsxs)(E.a,{className:r+" text-white",children:[Object(A.jsx)(E.a.Header,{children:Object(A.jsx)("h1",{children:t})}),Object(A.jsx)(E.a.Body,{className:"bg-secondary",children:Object(A.jsx)(E.a.Title,{children:Object(A.jsx)("h1",{children:n})})})]})})},B=n(72),F={headerStyle:{display:"flex",flexDircetion:"row",justifyContent:"space-between",textAlign:"center"},cardContainer:{margin:20,display:"flex",flexDirection:"row",justifyContent:"space-around"},buttonsStyle:{margin:35,display:"flex",flexDirection:"row",justifyContent:"space-around"}},M=function(e){var t=Object(O.c)((function(e){return e.Config.selectedCategory})),n=Object(O.c)((function(e){return e.Config.deskNum})),c=Object(r.useState)(0),a=Object(b.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(0),u=Object(b.a)(i,2),l=u[0],d=u[1],p=Object(r.useState)(!0),m=Object(b.a)(p,2),h=m[0],C=m[1],y=Object(O.c)((function(e){return e.Config.server})),k={loadAllCats:"".concat(y,"/api/cats"),getCategoryStatus:"".concat(y,"/api/cats/getStatus"),getNextCustomer:"".concat(y,"/api/cats/popCustomer"),repeatCustomer:"".concat(y,"/api/cats/repeatCustomerNumber"),socketServer:"".concat(y,"/")},S=function(){var e=Object(f.a)(j.a.mark((function e(n,r){var c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{console.log(r),c=n.filter((function(e){return parseInt(e.id)===parseInt(t.id)}))[0],console.log(n,t),o(c.current),d(null===c.waiting?0:c.waiting)}catch(a){console.log(a.message)}case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(j.a.mark((function e(){var r,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post(k.getNextCustomer,{id:t.id,window:n});case 3:return r=e.sent,c=r.data,e.next=7,v.a.post("".concat(x.sendCommand,"/"),{type:"A",num:c.customer});case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,h){e.next=5;break}w(),e.next=7;break;case 5:return e.next=7,v.a.post("".concat(x.sendCommand,"/"),{type:"ON",num:null});case 7:C(!h),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}(),P=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.post(k.repeatCustomer,{num:s,window:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)(Object(f.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(k.getCategoryStatus);case 2:t=e.sent,n=t.data,S(n.data,"http"),setInterval(Object(f.a)(j.a.mark((function e(){var t,n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(k.getCategoryStatus);case 2:t=e.sent,n=t.data,S(n.data,"http");case 5:case"end":return e.stop()}}),e)}))),1e3),Object(B.io)(k.socketServer).on("cats",(function(e){S(e.cats,"socket")}));case 8:case"end":return e.stop()}}),e)}))),[]),Object(A.jsx)("div",{children:Object(A.jsxs)("div",{children:[Object(A.jsxs)("div",{className:"alert alert-dark",style:F.headerStyle,children:[Object(A.jsx)("h2",{children:(null===t||void 0===t?void 0:t.name)?t.name:"-"}),Object(A.jsxs)("h2",{children:["Desk: ",n]}),Object(A.jsx)(g.a,{variant:"default",size:"lg",onClick:function(){return e.history.push("/settings")},children:Object(A.jsx)("span",{style:{fontSize:30,fontWeight:"bold",margin:0},children:"..."})})]}),Object(A.jsxs)("div",{style:F.cardContainer,children:[Object(A.jsx)(R,{title:"Current",content:s,type:"bg-info"}),Object(A.jsx)(R,{title:"Waiting",content:l,type:"bg-success"})]}),Object(A.jsxs)("div",{style:F.buttonsStyle,children:[Object(A.jsx)(g.a,{variant:"primary",size:"lg",onClick:w,children:"Next"}),Object(A.jsx)(g.a,{variant:"primary",size:"lg",onClick:P,children:"Repeat"}),Object(A.jsx)(g.a,{variant:h?"success":"danger",size:"lg",onClick:N,children:h?"ON":"OFF"})]})]})})},W=n(73),H=n.n(W),q=n.p+"static/media/logo.4b7f5575.jpg",G=function(e){var t=Object(O.b)(),n=Object(O.c)((function(e){return e.Config.configLoaded})),c=Object(r.useState)(!1),a=Object(b.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(!0),u=Object(b.a)(i,2),d=u[0],p=u[1],g=function(){var e=Object(f.a)(j.a.mark((function e(){var n,r,c,a,s,o,i;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(S(n=[{id:1,name:"Receiption"},{id:2,name:"M.R.I"}])),e.next=5,v.a.get(x.loadPorts);case 5:if(r=e.sent,c=r.data,t(N(c)),a=JSON.parse(localStorage.getItem("config"))){e.next=16;break}return e.next=12,v.a.get(x.loadConfig);case 12:s=e.sent,o=s.data,a=o,localStorage.setItem("config",JSON.stringify(a));case 16:t(I(a.desk)),t(P(a.comPort)),t(D(a.server)),i=n.filter((function(e){return parseInt(e.id)===parseInt(a.category)})),t(w(i[0])),t(z()),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),console.log(e.t0.message);case 27:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)(Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(x.connectToComPort);case 2:return t=e.sent,500===t.data.status&&o(!0),e.next=7,g();case 7:setTimeout((function(){p(!1)}),2e3);case 8:case"end":return e.stop()}}),e)}))),[]),Object(A.jsxs)("div",{children:[!d&&Object(A.jsxs)("div",{children:[s&&Object(A.jsx)(H.a,{title:"Serial Port Error",type:"error",onConfirm:function(){return o(!1)},children:Object(A.jsx)("h4",{children:"Please check cable is connected"})}),n&&Object(A.jsx)(M,Object(l.a)({},e))]}),d&&Object(A.jsx)("div",{children:Object(A.jsx)("img",{src:q,style:{heigh:"100vh",width:"100%",marginTop:"auto"}})})]})};var K=function(){return Object(A.jsx)("div",{className:"App",children:Object(A.jsx)(o.a,{children:Object(A.jsxs)(i.c,{children:[Object(A.jsx)(i.a,{path:"/settings",component:L}),Object(A.jsx)(i.a,{path:"/",component:G})]})})})},Q=(n(149),Object(C.a)({reducer:{Config:T}}));s.a.render(Object(A.jsx)(c.a.StrictMode,{children:Object(A.jsx)(O.a,{store:Q,children:Object(A.jsx)("div",{children:Object(A.jsx)(K,{})})})}),document.getElementById("root"))},79:function(e,t,n){},80:function(e,t,n){}},[[150,1,2]]]);
//# sourceMappingURL=main.4226cc2a.chunk.js.map